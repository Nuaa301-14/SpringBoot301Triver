<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:shiro="http://www.pollix.at/thymeleaf/shiro">
<head>
    <meta charset="UTF-8">
    <title>旅游资讯--旅游网站</title>
    <link rel="stylesheet" href="../../static/io/css/column.css">
    <link rel="stylesheet" href="../../static/io/css/basic.css">
    <link rel="stylesheet" type="text/css" href="/static/css/list.css"/>
    <link rel="stylesheet" type="text/css" href="/static/css/manhuaDate.1.0.css"/>
    <script type="text/javascript" src="/static/js/jquery-1.5.1.js"></script><!--日期控件，JS库版本不能过高否则tab会失效-->
    <script type="text/javascript" src="/static/js/datejs.js"></script>
    <script type="text/javascript" src="/static/js/ui.tab.js"></script>
<!--    <script type="text/javascript" src="/static/js/shaixuan.js"></script>-->
    <script type="text/javascript">
        $(document).ready(function () {
            var tab = new $.fn.tab({
                tabList: "#demo1 .ui-tab-container .ui-tab-list li",
                contentList: "#demo1 .ui-tab-container .ui-tab-content"
            });
            var tab = new $.fn.tab({
                tabList: "#demo1 .ui-tab-container .ui-tab-list2 li",
                contentList: "#demo1 .ui-tab-container .ui-tab-content2"
            });
        });
    </script>
<!--    <script type="text/javascript">-->
<!--        $(function () {-->
<!--            $("input.mh_date").datejs({-->
<!--                Event: "click",//可选-->
<!--                Left: 0,//弹出时间停靠的左边位置-->
<!--                Top: -16,//弹出时间停靠的顶部边位置-->
<!--                fuhao: "-",//日期连接符默认为- -->
<!--                isTime: false,//是否开启时间值默认为false-->
<!--                beginY: 2010,//年份的开始默认为1949-->
<!--                endY: 2015//年份的结束默认为2049-->
<!--            });-->

<!--        });-->
<!--    </script>-->
    <script type="text/javascript">
        $(document).ready(function (e) {
            $("#selectList").find(".more").toggle(function () {
                $(this).addClass("more_bg");
                $(".more-none").show()
            }, function () {
                $(this).removeClass("more_bg");
                $(".more-none").hide()
            });
        });
    </script>
    <script type="text/javascript">
        $(document).ready(function () {
            var taboy_box = $(".lefttable-list");
            taboy_box.children("tbody").find("tr:gt(2)").hide();
            $(".leftbox-morea").toggle(function () {
                    $(this).parent().prev().find("tr").show();
                    $(this).addClass("more-i")
                }, function () {
                    $(this).removeClass("more-i");
                    $(this).parent().prev().children("tbody").find("tr:gt(2)").hide();
                }
            );
        });
    </script>

</head>
<body>
<header>
    <nav id="nav">
        <div id="logo"><img src="/static/io/img/logo.png" alt=""></div>
        <ul>
            <li><a href="scenery.html">首页</a></li>
            <li class="active"><a href="informations.html">旅游资讯</a></li>
            <li><a href="ticket.html">酒店订购</a></li>
            <li><a href="index.html">景点资讯</a></li>
            <li class="layui-nav-item">
                <a href="/" th:if="${session.loginUser}==null">
                    <cite th:text="请登录"></cite>
                    <!--                    ${session.loginUser.userName}-->
                </a>
                <a href="/user/userInfo" th:if="${session.loginUser}!=null">
                    <cite th:if="${session.loginUser.userName}!=null"
                          th:text="你好+' '+${session.loginUser.userName}"></cite>
                    <cite th:if="${session.loginUser.userName}==null" th:text="你好+' '+${session.loginUser.name}"></cite>
                    <!--                    ${session.loginUser.userName}-->
                </a>
            </li>

        </ul>
    </nav>
</header>
<!--<div class="search">-->
<!--    <div class="center"></div>-->
<!--    <input class="input2" type="text" placeholder="请输入旅游景点或城市" id="searchtext">-->
<!--    <div class="button searchBtn">-->
<!--        搜索-->
<!--    </div>-->
<!--</div>-->

<br>
<div class="w1200">
    <div class="list-screen">
        <div class="screen-top" style="position:relative;">
            <span>目的地
                <input id="txtadress" type="text"/>
            </span>
            <span>出发地
                <input type="text" class="ju-adress" id="departure"/>
            </span>
            <span>跟团游名称
                <input type="text" class="ju-name" id="grouptravel_Name"/>
            </span>
            <a class="layui-btn layui-btn-danger search_btn" style="margin-left: 30px">具体查询</a>
        </div>
        <div style="padding:10px 30px 10px 10px;">
            <div class="screen-term">
                <div class="selectNumberScreen">
                    <div id="selectList" class="screenBox screenBackground">
                        <dl class="listIndex" attr="价格范围">
                            <dt>跟团游价格</dt>
                            <dd>
                                <label><a href="javascript:;" values2="" values1="" attrval="不限">不限</a></label>
                                <label>
                                    <input name="radio2" type="radio" value=""/>
                                    <a href="javascript:;" values2="99" values1="1" attrval="1-99">1000元以下</a></label>
                                <label>
                                    <input name="radio2" type="radio" value=""/>
                                    <a href="javascript:;" values2="300" values1="100"
                                       attrval="100-300">1000-2000元 </a></label>
                                <label>
                                    <input name="radio2" type="radio" value=""/>
                                    <a href="javascript:;" values2="600" values1="300"
                                       attrval="300-600">2000-3000元</a></label>
                                <label>
                                    <input name="radio2" type="radio" value=""/>
                                    <a href="javascript:;" values2="1500" values1="600"
                                       attrval="5000以上">3000-5000元</a></label>
                                <div class="custom"><span>自定义</span>&nbsp;
                                    <input name="" type="text" id="custext1"/>
                                    &nbsp;-&nbsp;
                                    <input name="" type="text" id="custext2"/>
                                    <input name="" type="button" id="cusbtn"/>
                                </div>
                            </dd>
                        </dl>
                        <dl class=" listIndex" attr="terminal_os_s">
                            <dt>跟团游品质</dt>
                            <dd>
                                <label><a href="javascript:;" values2="" values1="" attrval="不限">不限</a> </label>
                                <label>
                                    <input name="checkbox2" type="checkbox" value="" autocomplete="off"/>
                                    <a href="javascript:;" values2="" values1="" attrval="android">豪华</a></label>
                                <label>
                                    <input name="checkbox2" type="checkbox" value="" autocomplete="off"/>
                                    <a href="javascript:;" values2="" values1="" attrval="symbian">精致</a></label>
                                <label>
                                    <input name="checkbox2" type="checkbox" value="" autocomplete="off"/>
                                    <a href="javascript:;" values2="" values1="" attrval="百度易平台">性价比</a></label>
                            </dd>
                        </dl>
                        <dl class="listIndex" attr="terminal_brand_s">
                            <dt>来源</dt>
                            <dd data-more=true>
                                <label><a href="javascript:;" values2="" values1="" attrval="不限">不限</a></label>
                                <label>
                                    <input name="checkbox2" type="checkbox" value="" autocomplete="off"/>
                                    <a href="javascript:;" values2="" values1="" attrval="小米">携程</a></label>
                                <label>
                                    <input name="checkbox2" type="checkbox" value="" autocomplete="off"/>
                                    <a href="javascript:;" values2="" values1="" attrval="华为">同程</a> </label>
                                <label>
                                    <input name="checkbox2" type="checkbox" value="" autocomplete="off"/>
                                    <a href="javascript:;" values2="" values1="" attrval="lenovo">艺龙</a> </label>
                            </dd>
                        </dl>
                    </div>
                </div>
            </div>

        </div>
        <script type="text/javascript" src="/static/js/shaixuan.js"></script>
        <div class="hasBeenSelected clearfix"><span id="time-num"><font>0</font>个跟团游</span>
            <div style="float:right;" class="eliminateCriteria">【清空】</div>
            <dl>
                <dt>已选条件：</dt>
                <dd class=clearDd>
                    <div id="show" class=clearList>
                        <div id="showAllTag"></div>
                    </div>
            </dl>
        </div>
    </div>
</div>


<div id="container">
    <article class="list information">
        <div class="infos">
            <ul class="infos_left">
                <li><a href="">为您推荐</a></li>
            </ul>
            <ul class="infos_right">
                <li><a class="price" id="pricefirst">价格优先</a></li>
            </ul>

        </div>
        <link rel="stylesheet" href="/static/layui/css/layui.css" media="all">
        <script src="/static/layui/layui.all.js" charset="utf-8"></script>
        <script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js" charset="utf-8"></script>
        <script>
            function loaddata() {
                $.ajax({
                    //访问后台的路径
                    url: "/load_group",
                    dataType: "json",
                    contentType: "application/json;charset=utf-8",
                    type: 'post',//指定提交方式为post
                    success: function (data) {
                        var jsonData = JSON.stringify(data);
                        var spotlist = {};
                        jQuery.each(JSON.parse(jsonData), function (i, item) {
                            spotlist[i] = item;
                        });
                        dataHtml = '';
                        for (var i = 0; i < 9; i++) {
                            dataHtml += '<figure class="tour">'
                                + '<img src="../../static/io/img/tour' + ((i + 1) % 8) + '.jpg" alt="">'
                                + '<figcation class="description">'
                                + '<div class="content"> ' + spotlist[i].groupName + '</div>'
                                + '<ol><li><mark>' + '推荐' + '</mark>' + spotlist[i].commentNumber + '人推荐' + '</li>'
                                + '<li><mark>' + '已售' + '</mark>' + spotlist[i].soldNumber + '人已出游' + '</li>'
                                + '</ol>'
                                + '<div class="buy">' + '<div class="price">' + '￥' + '<strong>' + spotlist[i].groupPrice + '</strong>' + '</div>'
                                + '<div class="reserve">' + '<a href="' + spotlist[i].groupUrl + '" target="_blank">' + '立即抢购' + '</a>' + '</div>'
                                + '</div>'
                                + '<div class="disc">' + '<span>' + spotlist[i].groupScore + '分' + '</span></div>'
                                + '<div class="footer">' + '本跟团游由' + spotlist[i].supply + '赞助提供'
                                + '</div>'
                                + '</figcaption>'
                                + '</figure>'
                        }
                        $(".spotShow").html(dataHtml);
                    }
                });
            }

            window.onload = loaddata;

            var pageIndex = 1;
            var pageSize = 9;
            var currentPageIndex = 1;
            var recordCount = 0;
            var result;
            $(".search_btn").click(function () {
                search(1);
            });

            function search(page){
                result = searchGrouptravel();
                result.push({
                    page:page,
                    pageSize:9
                });
                var index = layer.msg('查询中，请稍候', {icon: 16, time: false, shade: 0.8});
                setTimeout(function () {
                    tosubmit(result);
                    toPage();
                    layer.close(index);
                }, 4000);
            }

            function loadnextpage(page){
                result = searchGrouptravel();
                result.push({
                    page:page,
                    pageSize:9
                });
                tosubmit(result);
            }

            function tosubmit(condition) {
                $.ajax({
                    //访问后台的路径
                    url: "/onclick_searchgroup",
                    //将数据通过函数转换
                    data: JSON.stringify(condition),
                    dataType: "json",//指定数据类型为JSON
                    // 指定类型，不然会报错，无法解析提交类型
                    contentType: "application/json;charset=utf-8",
                    type: 'post',//指定提交方式为post
                    success: function (data) {
                        pageIndex = data.pageNum;
                        recordCount = data.total;
                        if (data.list != null) {
                            getListInfo(data.list);
                        }
                    }
                });
            }

            function getListInfo(data) {
                var jsonData = JSON.stringify(data);
                var spotlist = {};
                jQuery.each(JSON.parse(jsonData), function (i, item) {
                    spotlist[i] = item;
                });
                dataHtml = '';
                for (var i = 0; i < 9; i++) {
                    dataHtml += '<figure class="tour">'
                        + '<img src="../../static/io/img/tour' + ((i + 1) % 8) + '.jpg" alt="">'
                        + '<figcation class="description">'
                        + '<div class="content"> ' + spotlist[i].groupName + '</div>'
                        + '<ol><li><mark>' + '推荐' + '</mark>' + spotlist[i].commentNumber + '人推荐' + '</li>'
                        + '<li><mark>' + '已售' + '</mark>' + spotlist[i].soldNumber + '人已买' + '</li>'
                        + '</ol>'
                        + '<div class="buy">' + '<div class="price">' + '￥' + '<strong>' + spotlist[i].groupPrice + '</strong>' + '</div>'
                        + '<div class="reserve">' + '<a href="' + spotlist[i].groupUrl + '" target="_blank">' + '立即抢购' + '</a>' + '</div>'
                        + '</div>'
                        + '<div class="disc">' + '<span>' + spotlist[i].groupScore + '分' + '</span></div>'
                        + '<div class="footer">' + '本跟团游由' + spotlist[i].supply + '赞助提供，更新于' + '<time>' + spotlist[i].time
                        + '</time></div>'
                        + '</figcaption>'
                        + '</figure>'
                }
                $(".spotShow").html(dataHtml);
            }

            function toPage() {
                layui.use(['laypage', 'layer'], function () {
                    var laypage = layui.laypage
                        , layer = layui.layer;
                    //总页数大于页码总数
                    laypage.render({
                        elem: 'page'
                        , layout: ['count', 'prev', 'page', 'next']
                        , count: recordCount //数据总数
                        , jump: function (obj, first) {
                            console.log(obj);
                            pageIndex = obj.curr;
                            if (!first) { //一定要加此判断，否则初始时会无限刷新
                                loadnextpage(obj.curr);
                            }
                        }
                    });
                })
            }

            $(function () {
                $(".price").click(function () {
                    $(this).removeClass("price");
                    $(this).addClass("selected");
                    tosubmit(1, 1);
                    toPage();
                });

            });
        </script>
        <div class="spotShow"></div>
        <div id="page"></div>

        <div class="more" onclick="loaddata()">换一换</div>
    </article>
    <aside class="sidebar">
        <div class="recommend sidebox">
            <h3>景点推荐</h3>
            <div class="tag">
                <ul>
                    <li><a href="###">曼谷(12)</a></li>
                    <li><a href="###">东京(5)</a></li>
                    <li><a href="###">西双版纳(8)</a></li>
                    <li><a href="###">漓江(16)</a></li>
                    <li><a href="###">呼伦贝尔(4)</a></li>
                    <li><a href="###">首尔(9)</a></li>
                    <li><a href="###">巴厘岛(15)</a></li>
                    <li><a href="###">土耳其(22)</a></li>
                    <li><a href="###">夏威夷(5)</a></li>
                    <li><a href="###">巴厘岛(11)</a></li>
                    <li><a href="###">毛里求斯(7)</a></li>
                    <li><a href="###">吉普岛(4)</a></li>
                    <li><a href="###">希腊(18)</a></li>
                    <li><a href="###">法瑞意(8)</a></li>
                    <li><a href="###">马尔代夫(9)</a></li>
                    <li><a href="###">新西兰(16)</a></li>
                    <li><a href="###">埃及(11)</a></li>
                    <li><a href="###">迪拜(14)</a></li>
                    <li><a href="###">斯里兰卡(7)</a></li>
                    <li><a href="###">麦哈顿(3)</a></li>
                    <li><a href="###">大阪(15)</a></li>
                </ul>
            </div>
        </div>
        <div class="hot sidebox">
            <h3>热门旅游</h3>
            <div class="figure">
                <figure>
                    <img src="../../static/io/img/hot1.jpg" alt="曼谷-芭提雅6日游">
                    <figcaption>曼谷-芭提雅6日游</figcaption>
                </figure>
                <figure>
                    <img src="../../static/io/img/hot2.jpg" alt="马尔代夫双鱼6日游">
                    <figcaption>马尔代夫双鱼6日游</figcaption>
                </figure>
                <figure>
                    <img src="../../static/io/img/hot3.jpg" alt="海南双飞5日游">
                    <figcaption>海南双飞5日游</figcaption>
                </figure>
                <figure>
                    <img src="../../static/io/img/hot4.jpg" alt="富山大阪东京8日游">
                    <figcaption>富山大阪东京8日游</figcaption>
                </figure>
            </div>
        </div>
        <div class="treasure sidebox">
            <h3>旅游百宝箱</h3>
            <div class="box">
                <a href="" class="trea1">天气预报</a>
                <a href="" class="trea2">火车票查询</a>
                <a href="" class="trea3">航空查询</a>
                <a href="" class="trea4">地铁线路查询</a>
            </div>
        </div>
    </aside>
</div>

<footer id="footer">
    <div class="top">
        <div class="block middle">
            <h3>合作伙伴</h3>
            <hr>
            <ul>
                <li><a target="_blank" href="https://www.ly.com/">同程旅游网</a></li>
                <li><a target="_blank" href="https://www.elong.com/">艺龙旅游网</a></li>
                <li><a target="_blank" href="https://www.ctrip.com/">携程旅游</a></li>
            </ul>


        </div>
        <div class="bottom">Copyright © 1616301</div>
    </div>
</footer>
</body>
</html>