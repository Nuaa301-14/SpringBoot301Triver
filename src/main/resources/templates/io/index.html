<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>首页--旅游网站</title>
	<link rel="stylesheet" href="../../static/io/css/iostyle.css">
	<link rel="stylesheet" href="../../static/io/css/basic.css">
</head>
<body>
<header>
	<nav id="nav">
	<div id="logo"><img src="../../static/io/img/logo.png" alt=""></div>
	<ul>
		<li class="active"><a href="index.html">首页</a></li>
		<li><a href="informations.html">旅游资讯</a></li>
		<li><a href="ticket.html">酒店订购</a></li>
		<li><a href="scenery.html">风景欣赏</a></li>
		<li><a href="about.html">公司简介</a></li>
	</ul>
	</nav>
</header>
<div class="search">
    <div class="center"></div>
    <input class="input" type="text" placeholder="请输入旅游景点或城市" id="searchtext">
    <div class="button searchBtn">
        搜索
	</div>
</div>
<div class="tour">
	<section class="news">
	<h2>热门旅游</h2>
	<p>国内旅游、国外旅游、自助旅游、自驾旅游、油轮签证、主题旅游等各种最新热门旅游推荐</p>
	</section>
	<link rel="stylesheet" href="/static/layui/css/layui.css" media="all">
	<script src="/static/layui/layui.all.js" charset="utf-8"></script>
	<!-- 注意：如果你直接复制所有代码到本地，上述js路径需要改成你本地的 -->
    <script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js" charset="utf-8"></script>
	<script >
        function loaddata()
        {
            $.ajax({
                //访问后台的路径
                url: "/load_data",
                dataType:"json",
                contentType: "application/json;charset=utf-8",
                type: 'post',//指定提交方式为post
                success: function(data) {
                    var jsonData = JSON.stringify(data);
                    var spotlist = {};
                    jQuery.each(JSON.parse(jsonData),function(i,item){
                        spotlist[i] = item;
                    });
                    dataHtml='';
                    for (var i=0;i<9;i++){
                        dataHtml+='<figure>'
                            +'<a href="'+spotlist[i].spotUrl+'"><img src="../../static/io/img/tour'+(i+1)+'.jpg" alt=""></a>'
                            + '<figcaption>'
                            + '<h3 class="content" > &lt;'+ spotlist[i].spotName +'&gt;</h3>'
                                + spotlist[i].introduce
                                +'<div class="info">'
                                +'<em class="sat">'+ '满意度'+spotlist[i].spotScore +'</em>'
                                +'<span class="price">'+ '￥'+spotlist[i].spotPrice +'</span>'
                                +'</div>'
                                +'<div>'+spotlist[i].spotLocation +'———'+spotlist[i].recommend+'人推荐'+'</div>'
                            +'</figcaption>'
                            +'</figure>'
                    }
                    $(".spotShow").html(dataHtml);
                }
            });
        }
        window.onload = loaddata;


        $(".searchBtn").click(function () {
            tosubmit(1);
            toPage();
        });

        var pageIndex = 1;
        var pageSize = 9;
        var currentPageIndex = 1;
        var recordCount = 0;

        function tosubmit(cur){
            var textstr = document.getElementById("searchtext").value;
            // var typestr = document.getElementById("searchtype").value;
            if (textstr == "" || textstr == null) {
                return;
            }
            var searchList = new Array();
            searchList.push({text: textstr, yehao: cur});
            $.ajax({
                //访问后台的路径
                url: "/onclick_search",
                //将数据通过函数转换
                data: JSON.stringify(searchList),
                dataType: "json",//指定数据类型为JSON
                // 指定类型，不然会报错，无法解析提交类型
                contentType: "application/json;charset=utf-8",
                type: 'post',//指定提交方式为post
                success: function (data) {
                    pageIndex = data.pageNum;
                    recordCount = data.total;
                    if (data.list != null) {
                        getListInfo(data.list);
                    }
                }
            });

        }

        function getListInfo(data){
            var jsonData = JSON.stringify(data);
            var spotlist = {};
            jQuery.each(JSON.parse(jsonData), function (i, item) {
                spotlist[i] = item;
            });
            dataHtml = '';
            for (var i = 0; i < 9; i++) {
                dataHtml += '<figure>'
                    + '<a href="' + spotlist[i].spotUrl + '"><img src="../../static/io/img/tour' + (i + 1) + '.jpg" alt=""></a>'
                    + '<figcaption>'
                    + '<h3 class="content" > &lt;' + spotlist[i].spotName + '&gt;</h3>'
                    + spotlist[i].introduce
                    + '<div class="info">'
                    + '<em class="sat">' + '满意度' + spotlist[i].spotScore + '</em>'
                    + '<span class="price">' + '￥' + spotlist[i].spotPrice + '</span>'
                    + '</div>'
                    + '<div>' + spotlist[i].spotLocation + '———' + spotlist[i].recommend + '人推荐' + '</div>'
                    + '</figcaption>'
                    + '</figure>'
            }
            $(".spotShow").html(dataHtml);
        }


        function toPage() {
            layui.use(['laypage', 'layer'], function(){
                var laypage = layui.laypage
                    ,layer = layui.layer;
                //总页数大于页码总数
                laypage.render({
                    elem: 'page'
                    ,layout: ['count', 'prev', 'page', 'next' ]
                    ,count: recordCount //数据总数
                    ,jump: function(obj,first){
                        console.log(obj);
                        pageIndex = obj.curr;
                        if(!first){ //一定要加此判断，否则初始时会无限刷新
                            tosubmit(obj.curr);//一定要把翻页的ajax请求放到这里，不然会请求两次。
                        }
                    }
                });
            })
        }

        // layui.use(['laypage', 'layer'], function() {
        //     var laypage = layui.laypage
        //         , layer = layui.layer;




        //     function search() {
        //         var textstr = document.getElementById("searchtext").value;
        //         var typestr = document.getElementById("searchtype").value;
        //         if (textstr == "" || textstr == null) {
        //             return;
        //         }
        //         var searchList = new Array();
        //         searchList.push({text: textstr, type: typestr});
        //
        //         $.ajax({
        //             //访问后台的路径
        //             url: "/onclick_search",
        //             //将数据通过函数转换
        //             data: JSON.stringify(searchList),
        //             dataType: "json",//指定数据类型为JSON
        //             // 指定类型，不然会报错，无法解析提交类型
        //             contentType: "application/json;charset=utf-8",
        //             type: 'post',//指定提交方式为post
        //             success: function (data) {
        //                 var jsonData = JSON.stringify(data);
        //                 var spotlist = {};
        //                 jQuery.each(JSON.parse(jsonData), function (i, item) {
        //                     spotlist[i] = item;
        //                 });
        //                 laypage.render({
        //                     elem: 'demo20'
        //                     , count: spotlist.length
        //                     // , layout: ['count', 'prev', 'page', 'next', 'limit', 'refresh', 'skip']
        //                     , jump: function (obj) {
        //                         dataHtml = '';
        //                         for (var i = obj.curr; i < obj.limit; i++) {
        //                             dataHtml += '<figure>'
        //                                 + '<a href="' + spotlist[i].spotUrl + '"><img src="../../static/io/img/tour' + (i + 1) + '.jpg" alt=""></a>'
        //                                 + '<figcaption>'
        //                                 + '<h3 class="content" > &lt;' + spotlist[i].spotName + '&gt;</h3>'
        //                                 + spotlist[i].introduce
        //                                 + '<div class="info">'
        //                                 + '<em class="sat">' + '满意度' + spotlist[i].spotScore + '</em>'
        //                                 + '<span class="price">' + '￥' + spotlist[i].spotPrice + '</span>'
        //                                 + '</div>'
        //                                 + '<div>' + spotlist[i].spotLocation + '———' + spotlist[i].recommend + '人推荐' + '</div>'
        //                                 + '</figcaption>'
        //                                 + '</figure>'
        //                         }
        //                         $(".spotShow").html(dataHtml);
        //                     }
        //                 });
        //             }
        //
        //         });
        //
        //     }
        // });
	</script>

	<div class = "spotShow"></div>
	<div id="page"></div>

	<!--<figure>-->
	<!--<img src="../../static/io/img/tour1.jpg" alt="">-->
	<!--<figcaption>-->
	<!--<strong class="title"> &lt;曼谷-芭提雅6日游&gt;</strong> 包团特惠，超丰富景点，升级1晚国五，无自费，更赠送600元/成人自费券-->
	<!--<div class="info">-->
	    <!--<em class="sat">满意度 77%</em>-->
		<!--<span class="price">￥ <strong>2864</strong> 起</span>-->
	<!--</div>-->
	<!--<div class="type">国内长线</div>-->

	<!--</figcaption>-->
	<!--</figure>-->
	<!--<figure>-->
	<!--<img src="../../static/io/img/tour1.jpg" alt="">-->
	<!--<figcaption>-->
	<!--<strong class="title"> &lt;曼谷-芭提雅6日游&gt;</strong> 包团特惠，超丰富景点，升级1晚国五，无自费，更赠送600元/成人自费券-->
	<!--<div class="info">-->
	    <!--<em class="sat">满意度 77%</em>-->
		<!--<span class="price">￥ <strong>2864</strong> 起</span>-->
	<!--</div>-->
	<!--<div class="type">国内长线</div>-->

	<!--</figcaption>-->
	<!--</figure>-->
	<!--<figure>-->
	<!--<img src="../../static/io/img/tour1.jpg" alt="">-->
	<!--<figcaption>-->
	<!--<strong class="title"> &lt;曼谷-芭提雅6日游&gt;</strong> 包团特惠，超丰富景点，升级1晚国五，无自费，更赠送600元/成人自费券-->
	<!--<div class="info">-->
	    <!--<em class="sat">满意度 77%</em>-->
		<!--<span class="price">￥ <strong>2864</strong> 起</span>-->
	<!--</div>-->
	<!--<div class="type">国内长线</div>-->

	<!--</figcaption>-->
	<!--</figure>-->
	<!--<figure>-->
	<!--<img src="../../static/io/img/tour1.jpg" alt="">-->
	<!--<figcaption>-->
	<!--<strong class="title"> &lt;曼谷-芭提雅6日游&gt;</strong> 包团特惠，超丰富景点，升级1晚国五，无自费，更赠送600元/成人自费券-->
	<!--<div class="info">-->
	    <!--<em class="sat">满意度 77%</em>-->
		<!--<span class="price">￥ <strong>2864</strong> 起</span>-->
	<!--</div>-->
	<!--<div class="type">国内长线</div>-->

	<!--</figcaption>-->
	<!--</figure>-->
	<!--<figure>-->
	<!--<img src="../../static/io/img/tour1.jpg" alt="">-->
	<!--<figcaption>-->
	<!--<strong class="title"> &lt;曼谷-芭提雅6日游&gt;</strong> 包团特惠，超丰富景点，升级1晚国五，无自费，更赠送600元/成人自费券-->
	<!--<div class="info">-->
	    <!--<em class="sat">满意度 77%</em>-->
		<!--<span class="price">￥ <strong>2864</strong> 起</span>-->
	<!--</div>-->
	<!--<div class="type">国内长线</div>-->

	<!--</figcaption>-->
	<!--</figure>-->
	<!--<figure>-->
	<!--<img src="../../static/io/img/tour1.jpg" alt="">-->
	<!--<figcaption>-->
	<!--<strong class="title"> &lt;曼谷-芭提雅6日游&gt;</strong> 包团特惠，超丰富景点，升级1晚国五，无自费，更赠送600元/成人自费券-->
	<!--<div class="info">-->
	    <!--<em class="sat">满意度 77%</em>-->
		<!--<span class="price">￥ <strong>2864</strong> 起</span>-->
	<!--</div>-->
	<!--<div class="type">国内长线</div>-->

	<!--</figcaption>-->
	<!--</figure>-->
	<!--<figure>-->
	<!--<img src="../../static/io/img/tour1.jpg" alt="">-->
	<!--<figcaption>-->
	<!--<strong class="title"> &lt;曼谷-芭提雅6日游&gt;</strong> 包团特惠，超丰富景点，升级1晚国五，无自费，更赠送600元/成人自费券-->
	<!--<div class="info">-->
	    <!--<em class="sat">满意度 77%</em>-->
		<!--<span class="price">￥ <strong>2864</strong> 起</span>-->
	<!--</div>-->
	<!--<div class="type">国内长线</div>-->

	<!--</figcaption>-->
	<!--</figure>-->
	<!--<figure>-->
	<!--<img src="../../static/io/img/tour1.jpg" alt="">-->
	<!--<figcaption>-->
	<!--<strong class="title"> &lt;曼谷-芭提雅6日游&gt;</strong> 包团特惠，超丰富景点，升级1晚国五，无自费，更赠送600元/成人自费券-->
	<!--<div class="info">-->
	    <!--<em class="sat">满意度 77%</em>-->
		<!--<span class="price">￥ <strong>2864</strong> 起</span>-->
	<!--</div>-->
	<!--<div class="type">国内长线</div>-->

	<!--</figcaption>-->
	<!--</figure>-->
	<!--<figure>-->
	<!--<img src="../../static/io/img/tour1.jpg" alt="">-->
	<!--<figcaption>-->
	<!--<strong class="title"> &lt;曼谷-芭提雅6日游&gt;</strong> 包团特惠，超丰富景点，升级1晚国五，无自费，更赠送600元/成人自费券-->
	<!--<div class="info">-->
	    <!--<em class="sat">满意度 77%</em>-->
		<!--<span class="price">￥ <strong>2864</strong> 起</span>-->
	<!--</div>-->
	<!--<div class="type">国内长线</div>-->

	<!--</figcaption>-->
	<!--</figure>-->
	</div>
	<footer id="footer">
	<div class="top">
	<div class="block left">
	<h3>合作伙伴</h3>
	<hr>
	<ul>
		<li>途牛旅游网</li>
		<li>驴妈妈旅游网</li>
		<li>携程旅游</li>
		<li>中国去青年旅行社</li>
	</ul>

	</div>
	<div class="block middle">
	<h3>旅游FAQ</h3>
	<hr>
	<ul>
		<li>旅游合同签订方式？</li>
		<li>儿童价是基于什么制定的？</li>
		<li>旅游的线路品质怎么界定的？</li>
		<li>单房差是什么？</li>
		<li>旅游保险有那些种类？</li>
	</ul>
	</div>
	<div class="block right">
	<h3>联系方式</h3>
	<hr>
	<ul>
		<li>微博：weibo.com/xuehua</li>
		<li>邮件：xuehua@xuehua.com</li>
		<li>地址：江苏盐城无名路123 号</li>

	</ul>
	</div>
	
	</div>
	<div class="bottom">Copyright © XUEHUA 雪花旅行社| 苏ICP 备120110119 号| 旅行社经营许可证：L-YC-BK12345</div>
	</footer>
</body>
</html>